import{_ as M,u as U,N as P,s as x,r as C,z as V,b as p,o as r,c as n,i as g,w as _,k as m,t as A,l as u,d as c,T as w,e as i,J as R,P as B}from"./index.86315cfc.js";import{u as S,r as h,e as N}from"./index.esm.01d3def0.js";const T={props:{edit:Boolean},setup(){const f=U(),t=P(),{message:a}=x(P()),e=C(!1),{user:s}=x(U()),b={firstname:{required:h},lastname:{required:h},email:{required:h,email:N}},v=S(b,s),o=V(()=>s.value.email&&s.value.firstname&&s.value.lastname),y=V(()=>s.value.role==="administrator"||s.value.role==="super-administrator");return{user:s,message:a,rules:b,v$:v,isRegistered:function(){return f.getUser.role},validation:o,register:async function(){try{e.value=!0,t.setMessage({text:"Registering user...",type:"info",spinner:!0}),await w.registerUser(s.value).then(()=>{t.setMessage({text:"Successfully registered user!",type:"success"})})}catch(d){console.error(d),e.value=!0,t.setMessage({text:"User could not be registered.",type:"error"})}},update:async function(){try{e.value=!0,t.setMessage({text:"Updating user...",type:"info",spinner:!0}),await w.updateUser(s.value.guid,s.value),t.setMessage({text:"Successfully updated user!",type:"success"})}catch(d){console.error(d),e.value=!0,t.setMessage({text:"User could not be updated.",type:"error"})}},activeMessage:e,isAdmin:y}}},E={key:0},Y={key:1},I=i(" You are currently registered as a(n) "),D=i(". "),q={key:2},z=i(" Your profile is not currently eligible to submit and event registration. If you believe this is a mistake, please contact "),H=m("a",{href:"mailto: PremiersAwards@gov.bc.ca"},"PremiersAwards@gov.bc.ca",-1),J=i(". "),j=[z,H,J],F={key:3},G=i("Update"),K=i("Register"),L={key:0},O=m("p",{class:"p-error"},[i(" Please contact "),m("a",{href:"mailto: PremiersAwards@gov.bc.ca"},"PremiersAwards@gov.bc.ca"),i(" if you need to update your personal profile information. ")],-1),Q=[O];function W(f,t,a,e,s,b){const v=p("PrimeMessage"),o=p("InputText"),y=p("PrimeButton"),k=p("PrimeCard");return r(),n("div",null,[e.isRegistered()?(r(),g(v,{key:0,show:"",variant:"info",closable:!1},{default:_(()=>[e.user.role==="inactive"?(r(),n("p",E," Your registration is currently under review. Please check back regularly for updates. ")):(r(),n("p",Y,[I,m("b",null,A(e.user.role),1),D])),e.user.role!=="inactive"&&e.user.eventregistrar===!1&&!e.isAdmin||e.user.eventregistrar===void 0?(r(),n("p",q,j)):e.user.role!=="inactive"&&e.user.eventregistrar===!0?(r(),n("p",F," You are currently eligible to submit an event registration. ")):u("",!0)]),_:1})):u("",!0),e.activeMessage?(r(),g(v,{key:1,show:"",variant:e.message.type,life:5e3,sticky:!1},{default:_(()=>[m("p",null,A(e.message.text),1)]),_:1},8,["variant"])):u("",!0),!e.isRegistered()||a.edit?(r(),g(k,{key:2},{content:_(()=>[m("form",null,[c(o,{id:"input-user-register-username",title:"username",disabled:!0,value:e.user.username},null,8,["value"]),c(o,{id:"input-user-register-firstname",title:"first name",modelValue:e.user.firstname,"onUpdate:modelValue":t[0]||(t[0]=l=>e.user.firstname=l),placeholder:"Enter user's given name",disabled:a.edit&&!e.isAdmin},null,8,["modelValue","disabled"]),c(o,{id:"input-user-register-lastname",title:"last name",modelValue:e.user.lastname,"onUpdate:modelValue":t[1]||(t[1]=l=>e.user.lastname=l),placeholder:"Enter user's last name",disabled:a.edit&&!e.isAdmin},null,8,["modelValue","disabled"]),c(o,{type:"email",title:"email address",id:"input-user-register-email",modelValue:e.user.email,"onUpdate:modelValue":t[2]||(t[2]=l=>e.user.email=l),placeholder:"Enter user's email",disabled:a.edit&&!e.isAdmin},null,8,["modelValue","disabled"]),a.edit&&e.isAdmin?(r(),g(y,{key:0,onClick:e.update,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:_(()=>[G]),_:1},8,["onClick","disabled"])):!a.edit&&!e.isAdmin?(r(),g(y,{key:1,onClick:e.register,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:_(()=>[K]),_:1},8,["onClick","disabled"])):u("",!0)]),!e.isAdmin&&a.edit?(r(),n("small",L,Q)):u("",!0)]),_:1})):u("",!0)])}var X=M(T,[["render",W]]);const te={__name:"NewUser",props:{update:Boolean},setup(f){const a=f.update||!1;return(e,s)=>(r(),n("main",null,[c(B,{title:"User Profile",subtitle:"Update Personal Profile Details"}),c(X,{edit:R(a)},null,8,["edit"])]))}};export{te as default};
