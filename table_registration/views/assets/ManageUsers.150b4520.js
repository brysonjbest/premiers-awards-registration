import{_ as O,u as M,s as z,r as h,l as w,P as Q,b as p,o as _,c as I,d as t,h as A,w as a,j as y,M as r,N as i,g,e as u,t as c}from"./index.4facfd7c.js";const j={setup(){const f=M(),{users:o}=z(M()),H=f.isAdmin,l=f.isSuperAdmin,D=h(),L=h(w.get("roles")||[]),x=(w.get("roles")||[]).filter(s=>s.value!=="super-administrator"),R=s=>{const b=f.getUser;return s===b.guid};let d=h(!1);h([]);const S=async function(){try{d.value=!0,f.$reset,await f.getUsers(),d.value=!1}catch(s){d.value=!1,console.warn(s)}},N=function(s,b){return w.lookup(s,b)},v=s=>new Date(s).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),m=s=>new Date(s).toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit"}),U=h({global:{value:null,matchMode:r.CONTAINS},guid:{operator:i.OR,constraints:[{value:null,matchMode:r.EQUALS}]},username:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},firstname:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},lastname:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},email:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},role:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},createdAt:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},updatedAt:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]}}),C=()=>{V()},V=()=>{U.value={global:{value:null,matchMode:r.CONTAINS},guid:{operator:i.OR,constraints:[{value:null,matchMode:r.EQUALS}]},username:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},firstname:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},lastname:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},email:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},role:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},createdAt:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},updatedAt:{operator:i.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]}}},k=()=>{D.value.exportCSV()},e=h({}),n=h(!1),T=h(!1),P=h(!1),W=s=>{e.value={...s},T.value=!0},F=()=>{T.value=!1,n.value=!1},E=async function(s){s.preventDefault(),n.value=!0,f.updateUser(e.value.guid,e.value).then(()=>{T.value=!1,e.value={}}).then(S()).catch(b=>{console.log(b)}).finally(()=>{S()})},B=async function(){f.removeUser(e.value.guid).then(()=>{T.value=!1,e.value={}}).then(S()).catch(s=>{console.log(s)}).finally(()=>{S()})};return S(),{users:o,dt:D,userStore:f,loading:d,isAdmin:H,isSuperAdmin:l,selfAssignment:R,lookup:N,formatDate:v,formatTime:m,filters:U,clearFilters:C,exportCSV:k,userDialog:T,editUser:W,saveUser:E,deleteUser:B,user:e,roles:L,adminRoles:x,submitted:n,hideDialog:F,deleteUserDialog:P}},components:{PageHeader:Q}},q={key:0},G={style:{"text-align":"left"}},K={class:"p-input-icon-left"},Y=g("i",{class:"pi pi-search"},null,-1),J=u(" No users found. "),X=u(" Loading guest data. Please wait. "),Z=g("br",null,null,-1),$=g("br",null,null,-1),ee={class:"dropdown"},le=g("label",{for:"organization"},"Role:",-1),te={key:2,class:"p-error"},ae={class:"confirmation-content"},oe=g("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ne={key:0},re=u("Are you sure you want to delete user ");function se(f,o,H,l,D,L){const x=p("PageHeader"),R=p("Spinner"),d=p("Column"),S=p("Row"),N=p("Card"),v=p("Button"),m=p("InputText"),U=p("router-link"),C=p("DataTable"),V=p("Dropdown"),k=p("Dialog");return l.isAdmin?(_(),I("div",q,[t(x,{title:"Manage Users",subtitle:"Manage User Access and Accounts"}),l.loading?(_(),A(N,{key:0},{default:a(()=>[t(S,{class:"vh-50 text-center","align-v":"center"},{default:a(()=>[t(d,{id:"spinner"},{default:a(()=>[t(R,{label:"Loading..."})]),_:1})]),_:1})]),_:1})):y("",!0),t(C,{class:"p-datatable-sm",value:l.users,responsiveLayout:"stack",rows:10,ref:"dt",stripedRows:"",filters:l.filters,"onUpdate:filters":o[3]||(o[3]=e=>l.filters=e),filterDisplay:"menu",globalFilterFields:["guid","username","firstname","lastname","email","role"],loading:l.loading,showGridlines:"",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",rowsPerPageOptions:[10,20,50],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{header:a(()=>[g("div",G,[t(v,{icon:"pi pi-external-link",label:"Export",onClick:o[0]||(o[0]=e=>l.exportCSV(e))}),t(v,{type:"button",icon:"pi pi-filter-slash",label:"Clear",class:"p-button-outlined",onClick:o[1]||(o[1]=e=>l.clearFilters())}),g("span",K,[Y,t(m,{modelValue:l.filters.global.value,"onUpdate:modelValue":o[2]||(o[2]=e=>l.filters.global.value=e),placeholder:"Keyword Search"},null,8,["modelValue"])])])]),empty:a(()=>[J]),loading:a(()=>[X]),default:a(()=>[t(d,{field:"guid",header:"guid",key:"guid",class:"guid"},{body:a(({data:e})=>[u(c(e.guid),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by ID#"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"username",header:"Username",key:"username"},{body:a(({data:e})=>[u(c(e.username),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by Username"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"firstname",header:"First Name",key:"firstname"},{body:a(({data:e})=>[u(c(e.firstname),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by First Name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"lastname",header:"Last Name",key:"lastname"},{body:a(({data:e})=>[u(c(e.lastname),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by Last Name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"email",header:"Email",key:"email"},{body:a(({data:e})=>[u(c(e.email),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by Email"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"role",header:"Role",key:"role"},{body:a(({data:e})=>[u(c(l.lookup("roles",e.role)),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by role"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"createdAt",header:"Created:",key:"createdAt",sortable:!0},{body:a(({data:e})=>[u(c(l.formatDate(e.createdAt))+",",1),Z,u(c(l.formatTime(e.createdAt)),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by Date Created"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{field:"updatedAt",header:"Updated:",key:"updatedAt",sortable:!0},{body:a(({data:e})=>[u(c(l.formatDate(e.updatedAt))+",",1),$,u(" "+c(l.formatTime(e.updatedAt)),1)]),filter:a(({filterModel:e})=>[t(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,class:"p-column-filter",placeholder:"Search by Date Updated"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{exportable:!1,style:{"min-width":"8rem"},header:"Edit User:"},{body:a(e=>[e.data.role!=="super-administrator"&&e.data.role!==l.userStore.getUser.role?(_(),A(v,{key:0,icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:n=>l.editUser(e.data)},null,8,["onClick"])):y("",!0),t(U,{to:"/user/update"},{default:a(()=>[l.selfAssignment(e.data.guid)?(_(),A(v,{key:0,icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2"})):y("",!0)]),_:2},1024)]),_:1})]),_:1},8,["value","filters","loading"]),t(k,{visible:l.userDialog,"onUpdate:visible":o[6]||(o[6]=e=>l.userDialog=e),style:{width:"450px"},header:"Edit User Role",modal:!0,class:"p-fluid"},{footer:a(()=>[t(v,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:l.hideDialog},null,8,["onClick"]),l.selfAssignment(l.user.guid)?y("",!0):(_(),A(v,{key:0,label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:l.saveUser},null,8,["onClick"]))]),default:a(()=>[g("div",ee,[le,l.isSuperAdmin?(_(),A(V,{key:0,id:"organization",modelValue:l.user.role,"onUpdate:modelValue":o[4]||(o[4]=e=>l.user.role=e),options:l.roles,optionLabel:"text",optionValue:"value",placeholder:"Select a Role"},null,8,["modelValue","options"])):l.isAdmin?(_(),A(V,{key:1,id:"organization",modelValue:l.user.role,"onUpdate:modelValue":o[5]||(o[5]=e=>l.user.role=e),options:l.adminRoles,optionLabel:"text",optionValue:"value",placeholder:"Select a Role"},null,8,["modelValue","options"])):y("",!0),l.submitted&&!l.user.role?(_(),I("small",te,"Role is required.")):y("",!0)])]),_:1},8,["visible"]),t(k,{visible:l.deleteUserDialog,"onUpdate:visible":o[8]||(o[8]=e=>l.deleteUserDialog=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[t(v,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o[7]||(o[7]=e=>l.deleteUserDialog=!1)}),t(v,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:l.deleteUser},null,8,["onClick"])]),default:a(()=>[g("div",ae,[oe,f.registration?(_(),I("span",ne,[re,g("b",null,c(l.user.username),1),u(" for contact "+c(l.user.firstname)+" "+c(l.user.lastname)+"?",1)])):y("",!0)])]),_:1},8,["visible"])])):y("",!0)}var de=O(j,[["render",se]]);export{de as default};
