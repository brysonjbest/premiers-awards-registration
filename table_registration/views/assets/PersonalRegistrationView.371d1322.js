import{u as z,G as N}from"./GuestList.f47ce914.js";import{R as F}from"./RegistrationList.17f215a5.js";import{_ as L,a as A,s as q,r as b,b as u,o as a,c as d,h as x,w as y,e as k,t as h,j as r,d as i,n as V,k as _,F as T,l as U,f as G,I as H,J as M,u as O,P as j}from"./index.e4b240a4.js";import{u as E,r as R}from"./index.esm.b098ea4f.js";import"./InputFinancial.7e93237c.js";const J={props:{registrationID:String},setup(g){const t=z(),n=A(),{guest:e}=q(z()),I={organization:{required:R},firstname:{required:R},lastname:{required:R},attendancetype:{required:R}},D=E(I,e),f=b(G.get("organizations")||[]),v=b(G.get("attendancetypes")||[]),p=b(G.get("accessibilityoptions")||[]),c=b(G.get("dietaryoptions")||[]);g.registrationID&&n.fill(g.registrationID);let l=b(!1),m=b(!1);const s=b({severity:null,text:""});return{loading:l,message:m,messageText:s,guest:e,guestData:t,v$:D,organizations:f,dietary:c,accessibility:p,attendancetypes:v,rules:I,onSubmit:async function(C){if(C.preventDefault(),!!await this.v$.$validate()){this.guest.registration=n.getId;try{l.value=!0,t.registerGuest(this.guest).then(w=>t.addGuestList(w)).then(()=>{delete this.guest.guid,this.guest.organization="",this.guest.firstname="",this.guest.lastname="",this.guest.attendancetype="",this.guest.dietary=[],this.guest.accessibility=[],this.$forceUpdate,this.v$.$reset(),l.value=!1,m.value=!0,s.value={severity:"success",text:"Guest Updated!"}})}catch(w){l.value=!1,console.warn(w),m.value=!0,s.value={severity:"error",text:"Guest could not be updated."}}finally{setTimeout(()=>m.value=!1,1500)}}},onReset:function(C){C.preventDefault(),delete this.guest.guid,this.guest.organization="",this.guest.firstname="",this.guest.lastname="",this.guest.attendancetype="",this.guest.dietary=[],this.guest.accessibility=[]}}}},S=g=>(H("data-v-374d6f4c"),g=g(),M(),g),W={class:"dropdown"},K=S(()=>r("label",{for:"organization"},"Organization:",-1)),Q={key:0,class:"p-error",id:"organization-help"},X={class:"text-field"},Y=S(()=>r("label",{for:"firstname"},"First Name:",-1)),Z={key:0,class:"p-error",id:"firstname-help"},$={class:"text-field"},ee=S(()=>r("label",{for:"lastname"},"Last Name:",-1)),te={key:0,class:"p-error",id:"lastname-help"},se={class:"dropdown"},ae=S(()=>r("label",{for:"attendancetype"},"Attendance Type:",-1)),ne={key:0,class:"p-error",id:"attendancetype-help"},ie={class:"checkbox-group"},oe=S(()=>r("label",{for:"accessibility"},"Accessibility Requirements:",-1)),re=["for"],le={class:"checkbox-group"},de=S(()=>r("label",{for:"dietary"},"Dietary Requirements:",-1)),ue=["for"],ge=k("Add Guest"),ce=k("Reset");function me(g,t,n,e,I,D){const f=u("ProgressSpinner"),v=u("PrimeMessage"),p=u("DropDown"),c=u("InputText"),l=u("CheckBox"),m=u("PrimeButton");return a(),d("div",null,[e.loading?(a(),x(f,{key:0})):e.message?(a(),x(v,{key:1,severity:e.messageText.severity,closable:!1},{default:y(()=>[k(h(e.messageText.text),1)]),_:1},8,["severity"])):(a(),d("form",{key:2,onSubmit:t[6]||(t[6]=(...s)=>e.onSubmit&&e.onSubmit(...s)),onReset:t[7]||(t[7]=(...s)=>e.onReset&&e.onReset(...s))},[r("div",W,[K,i(p,{class:V({"p-invalid":e.v$.organization.$error}),id:"organization",modelValue:e.guest.organization,"onUpdate:modelValue":t[0]||(t[0]=s=>e.guest.organization=s),options:e.organizations,optionLabel:"text",optionValue:"value",placeholder:"Select a Organization"},null,8,["class","modelValue","options"]),e.v$.organization.$error?(a(),d("small",Q,"Please select your organization.")):_("",!0)]),r("div",X,[Y,i(c,{class:V({"p-invalid":e.v$.firstname.$error}),id:"firstname",type:"firstname","aria-describedby":"firstname-help",modelValue:e.guest.firstname,"onUpdate:modelValue":t[1]||(t[1]=s=>e.guest.firstname=s),placeholder:"First Name"},null,8,["class","modelValue"]),e.v$.firstname.$error?(a(),d("small",Z,"Please enter guest's first name.")):_("",!0)]),r("div",$,[ee,i(c,{class:V({"p-invalid":e.v$.lastname.$error}),id:"lastname",type:"lastname","aria-describedby":"lastname-help",modelValue:e.guest.lastname,"onUpdate:modelValue":t[2]||(t[2]=s=>e.guest.lastname=s),placeholder:"Last Name"},null,8,["class","modelValue"]),e.v$.lastname.$error?(a(),d("small",te,"Please enter guest's last name.")):_("",!0)]),r("div",se,[ae,i(p,{class:V({"p-invalid":e.v$.attendancetype.$error}),id:"attendancetype",modelValue:e.guest.attendancetype,"onUpdate:modelValue":t[3]||(t[3]=s=>e.guest.attendancetype=s),options:e.attendancetypes,optionLabel:"text",optionValue:"value",placeholder:"Select the type of attendance for this guest"},null,8,["class","modelValue","options"]),e.v$.attendancetype.$error?(a(),d("small",ne,"Please select the attendance type for this guest.")):_("",!0)]),r("div",ie,[oe,(a(!0),d(T,null,U(e.accessibility,s=>(a(),d("div",{key:s.key,class:"field-checkbox"},[i(l,{id:s.key,name:"each",value:s.value,modelValue:e.guest.accessibility,"onUpdate:modelValue":t[4]||(t[4]=o=>e.guest.accessibility=o)},null,8,["id","value","modelValue"]),r("label",{for:s.key},h(s.text),9,re)]))),128))]),r("div",le,[de,(a(!0),d(T,null,U(e.dietary,s=>(a(),d("div",{key:s.key,class:"field-checkbox"},[i(l,{id:s.key,name:"each",value:s.value,modelValue:e.guest.dietary,"onUpdate:modelValue":t[5]||(t[5]=o=>e.guest.dietary=o)},null,8,["id","value","modelValue"]),r("label",{for:s.key},h(s.text),9,ue)]))),128))]),i(m,{type:"submit",label:"primary",class:"p-button-raised"},{default:y(()=>[ge]),_:1}),i(m,{type:"reset",label:"danger",class:"p-button-raised p-button-danger"},{default:y(()=>[ce]),_:1})],32))])}var be=L(J,[["render",me],["__scopeId","data-v-374d6f4c"]]);const fe={props:{id:String},setup(g){const t=O();t.login();const n=A();n.fill(g.id);const e=()=>String(n.getTableCount),I=()=>String(n.getGuestCount),D=()=>n.getRegistrar,f=()=>n.getRegistration.submitted,v=()=>new Date(n.getRegistration.updatedAt).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),p=()=>t.isAdmin,c=async()=>{let P=!f();n.registerFinancialInformation({submitted:P,registration:g.id}).then(()=>n.fill(g.id))},l=b(!1),m=b(!1),s=b(!1);return{userStore:t,financialStore:n,tableCount:e,guestCount:I,getRegistrar:D,isSubmitted:f,isAdmin:p,toggleRegistration:c,addGuestDialog:l,tableInfoDialog:m,guestInfoDialog:s,addGuest:()=>{l.value=!0},tableInfo:()=>{m.value=!0},guestInfo:()=>{s.value=!0},dateSubmitted:v}},components:{GuestList:N,RegistrationList:F,InputGuest:be,PageHeader:j}},pe={key:0},ye={key:1},_e={key:0},ve=k(" Please ensure that the registration information on this page is complete prior to submitting your registration for the event. If you cannot complete the registration at this time, your current progress will remain saved here until you are ready to complete your submission. ");function he(g,t,n,e,I,D){const f=u("PageHeader"),v=u("PrimeCard"),p=u("RegistrationList"),c=u("PrimeButton"),l=u("PrimeDialog"),m=u("InputGuest"),s=u("GuestList");return a(),d("main",null,[i(f,{class:"pageheader",footer:`Registration # ${n.id} `},{default:y(()=>[e.isSubmitted()?(a(),d("span",pe,"Submitted "+h(e.dateSubmitted())+" by",1)):(a(),d("span",ye,"In-progress registration for")),k(" "+h(e.getRegistrar()),1)]),_:1},8,["footer"]),!e.isAdmin()&!e.isSubmitted()?(a(),d("div",_e,[r("div",null,[i(v,{id:"registration-info"},{content:y(()=>[ve]),_:1})])])):_("",!0),i(p,{registrationID:n.id,detailsView:!1},null,8,["registrationID"]),e.isSubmitted()?_("",!0):(a(),x(c,{key:1,label:"Add Guests",icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:t[0]||(t[0]=o=>e.addGuest())})),i(c,{type:"button",label:"Total Guests",icon:"pi pi-users",class:"p-button-warning",badge:e.guestCount(),onClick:t[1]||(t[1]=o=>e.guestInfo()),badgeClass:"p-badge-danger"},null,8,["badge"]),i(c,{type:"button",label:"Tables",icon:"pi pi-ticket",class:"p-button-warning",badge:e.tableCount(),onClick:t[2]||(t[2]=o=>e.tableInfo()),badgeClass:"p-badge-danger"},null,8,["badge"]),!e.isSubmitted()&&(e.guestCount()>=5||e.isAdmin())?(a(),x(c,{key:2,type:"button",label:"Submit Registration",icon:"pi pi-ticket",class:"p-button-warning",onClick:t[3]||(t[3]=o=>e.toggleRegistration()),badgeClass:"p-badge-danger"})):_("",!0),e.isSubmitted()&&e.isAdmin()?(a(),x(c,{key:3,type:"button",label:"Unsubmit Registration",icon:"pi pi-ticket",class:"p-button-warning",onClick:t[4]||(t[4]=o=>e.toggleRegistration()),badgeClass:"p-badge-danger"})):_("",!0),i(l,{visible:e.tableInfoDialog,"onUpdate:visible":t[5]||(t[5]=o=>e.tableInfoDialog=o),header:"Table Information",modal:!0,class:"p-fluid"},{default:y(()=>[k("Warning regarding table charges. Please be aware that half tables may not be able to be accomodated, and you may be charged the full table amount. Current table count: "+h(e.tableCount()),1)]),_:1},8,["visible"]),i(l,{visible:e.guestInfoDialog,"onUpdate:visible":t[6]||(t[6]=o=>e.guestInfoDialog=o),header:"Guest Information",modal:!0,class:"p-fluid"},{default:y(()=>[k("Total Number of Guests: "+h(e.guestCount())+". ",1)]),_:1},8,["visible"]),i(l,{visible:e.addGuestDialog,"onUpdate:visible":t[7]||(t[7]=o=>e.addGuestDialog=o),header:"Add a new Guest",modal:!0,class:"p-fluid"},{default:y(()=>[i(m,{registrationID:n.id},null,8,["registrationID"])]),_:1},8,["visible"]),i(s,{adminView:!1,registrationID:n.id},null,8,["registrationID"])])}var Ce=L(fe,[["render",he]]);export{Ce as default};
