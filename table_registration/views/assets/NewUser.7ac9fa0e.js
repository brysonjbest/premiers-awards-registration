import{_ as C,u as x,O as b,s as V,r as R,b as f,o as r,c as _,h as c,w as m,g as v,t as M,j as k,d as u,Q as B,e as y,B as w,P as S}from"./index.4facfd7c.js";import{u as P,r as U,e as N}from"./index.esm.469a7800.js";const E={props:{edit:Boolean},setup(g){const s=x(),t=b(),{message:e}=V(b()),a=R(!1),{user:o}=V(x()),d={firstname:{required:U},lastname:{required:U},email:{required:U,email:N}},i=g.edit||!1,p=P(d,o);return{user:o,message:e,rules:d,edit:i,v$:p,isRegistered:function(){const n=s.getUser;return this.mode==="register"&&!!n.role},validation:function(){return!!this.user.guid&&!!this.user.username},register:async function(){try{a.value=!0,t.setMessage({text:"Registering user...",type:"info",spinner:!0});const n=await B.registerUser(o.value);t.setMessage({text:"Successfully registered user!",type:"success"})}catch(n){console.error(n),a.value=!0,t.setMessage({text:"User could not be registered.",type:"error"})}},update:async function(){try{a.value=!0,t.setMessage({text:"Updating user...",type:"info",spinner:!0});const n=await B.updateUser(o.value.guid,o.value);t.setMessage({text:"Successfully updated user!",type:"success"})}catch(n){console.error(n),a.value=!0,t.setMessage({text:"User could not be updated.",type:"error"})}},activeMessage:a}}},T={key:0},D={key:1},I=y(" You are currently registered as a(n) "),Y=y(". "),j=y("Update"),q=y("Register");function A(g,s,t,e,a,o){const d=f("Message"),i=f("InputText"),p=f("Button"),h=f("Card");return r(),_("div",null,[e.user&&e.isRegistered?(r(),c(d,{key:0,show:"",variant:"info",closable:!1},{default:m(()=>[e.user.role==="inactive"?(r(),_("p",T," Your registration is currently under review. Please check back regularly for updates. ")):(r(),_("p",D,[I,v("b",null,M(e.user.role),1),Y]))]),_:1})):k("",!0),e.activeMessage?(r(),c(d,{key:1,show:"",variant:e.message.type,life:5e3,sticky:!1},{default:m(()=>[v("p",null,M(e.message.text),1)]),_:1},8,["variant"])):k("",!0),e.user&&(!e.isRegistered||e.edit)?(r(),c(h,{key:2},{content:m(()=>[v("form",null,[u(i,{id:"input-user-register-username",disabled:!0,value:e.user.username},null,8,["value"]),u(i,{id:"input-user-register-firstname",modelValue:e.user.firstname,"onUpdate:modelValue":s[0]||(s[0]=l=>e.user.firstname=l),placeholder:"Enter user's given name"},null,8,["modelValue"]),u(i,{id:"input-user-register-lastname",modelValue:e.user.lastname,"onUpdate:modelValue":s[1]||(s[1]=l=>e.user.lastname=l),placeholder:"Enter user's last name"},null,8,["modelValue"]),u(i,{type:"email",id:"input-user-register-email",modelValue:e.user.email,"onUpdate:modelValue":s[2]||(s[2]=l=>e.user.email=l),placeholder:"Enter user's email"},null,8,["modelValue"]),e.edit?(r(),c(p,{key:0,onClick:e.update,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:m(()=>[j]),_:1},8,["onClick","disabled"])):(r(),c(p,{key:1,onClick:e.register,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:m(()=>[q]),_:1},8,["onClick","disabled"]))])]),_:1})):k("",!0)])}var H=C(E,[["render",A]]);const G={__name:"NewUser",props:{update:Boolean},setup(g){const s=g,t=s.update||!1;return console.log(s),(e,a)=>(r(),_("main",null,[u(S,{title:"User Profile",subtitle:"Update Personal Profile Details"}),u(H,{edit:w(t)},null,8,["edit"])]))}};export{G as default};
