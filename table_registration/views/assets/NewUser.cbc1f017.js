import{_ as P,u as k,M as x,s as b,r as w,b as m,o as n,c as g,d as s,w as u,j as v,t as V,h as y,k as C,N as M,m as R,e as f,C as B,P as S}from"./index.aa6572cd.js";import{u as N,r as h,e as T}from"./index.esm.744f86eb.js";const E={props:{edit:Boolean},setup(){const d=k(),t=x(),{message:o}=b(x()),e=w(!1),{user:r}=b(k()),p={firstname:{required:h},lastname:{required:h},email:{required:h,email:T}},c=N(p,r);return{user:r,message:o,rules:p,v$:c,isRegistered:function(){const a=d.getUser;return this.mode==="register"&&!!a.role},validation:function(){return!!this.user.guid&&!!this.user.username},register:async function(){try{e.value=!0,t.setMessage({text:"Registering user...",type:"info",spinner:!0}),await M.registerUser(r.value).then(()=>{t.setMessage({text:"Successfully registered user!",type:"success"})}).then(await new Promise(a=>setTimeout(a,1500))).then(()=>{R.go()})}catch(a){console.error(a),e.value=!0,t.setMessage({text:"User could not be registered.",type:"error"})}},update:async function(){try{e.value=!0,t.setMessage({text:"Updating user...",type:"info",spinner:!0}),await M.updateUser(r.value.guid,r.value),t.setMessage({text:"Successfully updated user!",type:"success"})}catch(a){console.error(a),e.value=!0,t.setMessage({text:"User could not be updated.",type:"error"})}},activeMessage:e}}},D={key:0},I={key:1},Y=f(" You are currently registered as a(n) "),j=f(". "),q=f("Update"),A=f("Register");function H(d,t,o,e,r,p){const c=m("PrimeMessage"),l=m("InputText"),_=m("PrimeButton"),U=m("PrimeCard");return n(),g("div",null,[s(c,{show:"","v-if":e.user&&e.isRegistered(),variant:"info",closable:!1},{default:u(()=>[e.user.role==="inactive"?(n(),g("p",D," Your registration is currently under review. Please check back regularly for updates. ")):(n(),g("p",I,[Y,v("b",null,V(e.user.role),1),j]))]),_:1},8,["v-if"]),e.activeMessage?(n(),y(c,{key:0,show:"",variant:e.message.type,life:5e3,sticky:!1},{default:u(()=>[v("p",null,V(e.message.text),1)]),_:1},8,["variant"])):C("",!0),s(U,{"v-if":e.user&&(!e.isRegistered()||o.edit)},{content:u(()=>[v("form",null,[s(l,{id:"input-user-register-username",disabled:!0,value:e.user.username},null,8,["value"]),s(l,{id:"input-user-register-firstname",modelValue:e.user.firstname,"onUpdate:modelValue":t[0]||(t[0]=i=>e.user.firstname=i),placeholder:"Enter user's given name"},null,8,["modelValue"]),s(l,{id:"input-user-register-lastname",modelValue:e.user.lastname,"onUpdate:modelValue":t[1]||(t[1]=i=>e.user.lastname=i),placeholder:"Enter user's last name"},null,8,["modelValue"]),s(l,{type:"email",id:"input-user-register-email",modelValue:e.user.email,"onUpdate:modelValue":t[2]||(t[2]=i=>e.user.email=i),placeholder:"Enter user's email"},null,8,["modelValue"]),o.edit?(n(),y(_,{key:0,onClick:e.update,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:u(()=>[q]),_:1},8,["onClick","disabled"])):(n(),y(_,{key:1,onClick:e.register,disabled:!e.validation,class:"m-2",type:"button",variant:"info"},{default:u(()=>[A]),_:1},8,["onClick","disabled"]))])]),_:1},8,["v-if"])])}var z=P(E,[["render",H]]);const J={__name:"NewUser",props:{update:Boolean},setup(d){const o=d.update||!1;return(e,r)=>(n(),g("main",null,[s(S,{title:"User Profile",subtitle:"Update Personal Profile Details"}),s(z,{edit:B(o)},null,8,["edit"])]))}};export{J as default};
